#include<bits/stdc++.h>
using namespace std;
int dx[24] = {-2, -2, -2, -2, -2, -1, -1, -1, -1, -1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2};
int dy[24] = {-2, -1, 0, 1, 2, -2, -1, 0, 1, 2, -2, -1, 1, 2, -2, -1, 0, 1, 2, -2, -1, 0, 1, 2};
int board[14500][16][16]={},cnt=1,ma=0;
long long int score[14500];

void input();

int tree(void){
	int i, temp = -1;
	printf("\n");
	for(i = 25; i <= 600; i++){
		if(score[i/24] == -100000000000){
			i += 23;
		}
		if(score[i] != -100000000000){
			score[i/24] = max(score[i/24], score[i]);
		}
	}
	for(i = 601; i <= 14424; i++){
		if(score[i/24] == -100000000000){
			i += 24*24-1;
		}
		if(score[i] != -100000000000){
			score[i/24] = min(score[i/24], score[i]);
		}
	}
	long long int s = -100000000001;
	for(i = 1; i <= 24; i++){
		if(score[i] != -100000000000){
			if(score[i] >= s){
				temp = i;
				s = score[i];
			}
		}
	}
	for(i = 1; i <= 24; i++){
		printf("%d ", score[i]);
	}
	return temp;
}


int sc(int index){		//평가함수 플레이어 에게 유리할때는 음수, AI에게 유리할때는 양수 
	int i, j, s = 0,temp, tf, sc;
	for(i = 1; i <= 15; i++){
		temp = 0;
		tf = 0;
		for(j = 1; j <= 15; j++){
			if(board[index][i][j] == 2){
				if(tf == 0){
					tf = 1;
					temp = 0;
				}
				else{
					temp++;
				}
			}
			else{
				if(tf == 1){
					sc = 1;
					while(temp--){
						sc *= 100;
					}
					s += sc;
					tf = 0;
				}
			}
		}
		if(tf == 1){
			sc = 1;
			while(temp--){
				sc *= 100;
			}
			s += sc;
		}
		temp = 0;
		tf = 0;
		for(j = 1; j <= 15; j++){
			if(board[index][j][i] == 2){
				if(tf == 0){
					tf = 1;
					temp = 0;
				}
				else{
					temp++;
				}
			}
			else{
				if(tf == 1){
					sc = 1;
					while(temp--){
						sc *= 100;
					}
					s += sc;
					tf = 0;
				}
			}
		}
		if(tf == 1){
			sc = 1;
			while(temp--){
				sc *= 100;
			}
			s += sc;
		}
	}
	for(i = 1; i <= 15; i++){
		tf = 0;
		temp = 0;
		for(j = 1; j<= i;j++){
			if(board[index][16-i][j] == 2){
				if(tf == 0){
					tf = 1;
					temp = 0;
				}
				else{
					temp++;
				}
			}
			else{
				if(tf == 1){
					sc = 1;
					while(temp--){
						sc *= 100;
					}
					s += sc;
					tf = 0;
				}
			}
		}
		if(tf == 1){
			sc = 1;
			while(temp--){
				sc *= 100;
			}
			s += sc;
		}
		tf = 0;
		temp = 0;
		for(j = 1; j<= i;j++){
			if(board[index][16-i][16-j] == 2){
				if(tf == 0){
					tf = 1;
					temp = 0;
				}
				else{
					temp++;
				}
			}
			else{
				if(tf == 1){
					sc = 1;
					while(temp--){
						sc *= 100;
					}
					s += sc;
					tf = 0;
				}
			}
		}
		if(tf == 1){
			sc = 1;
			while(temp--){
				sc *= 100;
			}
			s += sc;
		}
	}
	for(i = 1; i <= 15; i++){
		temp = 0;
		tf = 0;
		for(j = 1; j <= 15; j++){
			if(board[index][i][j] == 1){
				if(tf == 0){
					tf = 1;
					temp = 0;
				}
				else{
					temp++;
				}
			}
			else{
				if(tf == 1){
					sc = 1;
					while(temp--){
						sc *= 100;
					}
					s -= sc;
					tf = 0;
				}
			}
		}
		if(tf == 1){
			sc = 1;
			while(temp--){
				sc *= 100;
			}
			s -= sc;
		}
		temp = 0;
		tf = 0;
		for(j = 1; j <= 15; j++){
			if(board[index][j][i] == 1){
				if(tf == 0){
					tf = 1;
					 temp = 0;
				}
				else{
					temp++;
				}
			}
			else{
				if(tf == 1){
					sc = 1;
					while(temp--){
						sc *= 100;
					}
					s -= sc;
					tf = 0;
				}
			}
		}
		if(tf == 1){
			sc = 1;
			while(temp--){
				sc *= 100;
			}
			s -= sc;
		}
	}
	for(i = 1; i <= 15; i++){
		tf = 0;
		temp = 0;
		for(j = 1; j<= i;j++){
			if(board[index][16-i][j] == 1){
				if(tf == 0){
					tf = 1;
					temp = 0;
				}
				else{
					temp++;
				}
			}
			else{
				if(tf == 1){
					sc = 1;
					while(temp--){
						sc *= 100;
					}
					s -= sc;
					tf = 0;
				}
			}
		}
		if(tf == 1){
			sc = 1;
			while(temp--){
				sc *= 100;
			}
			s -= sc;
		}
		tf = 0;
		temp = 0;
		for(j = 1; j<= i;j++){
			if(board[index][16-i][16-j] == 1){
				if(tf == 0){
					tf = 1;
					temp = 0;
				}
				else{
					temp++;
				}
			}
			else{
				if(tf == 1){
					sc = 1;
					while(temp--){
						sc *= 100;
					}
					s -= sc;
					tf = 0;
				}
			}
		}
		if(tf == 1){
			sc = 1;
			while(temp--){
				sc *= 100;
			}
			s -= sc;
		}
	}
	return s;
}


void copy(int a, int b){	//b 보드에 a보드를 복사함  
	for(int i = 1; i <= 15; i++){
		for(int j = 1; j<= 15; j++){
			board[b][i][j] =  board[a][i][j];
		}
	}
}

void title(){ //타이틀
  ma++;
  system("cls");
  puts("Tic-Tac-Toe");
  int a;
  cout << "1.Start 2.Exit : ";
  while(1){
  	cin >> a;
  	if(a==1){
    	input();
  	}
    else if(a==2) exit(0);
  	else cout << "잘못된 입력입니다. 다시 입력해주세요 : " ;
  }
}

void re(){ //다시하기 입력받는 함수
	char a;
	while(1){
	cin >> a;
	if(a=='Y'||a=='y'){
		system("cls");
		puts("0 1 2 3");    //제일처음 판 출력
		puts("1 - - -");
		puts("2 - - -");
		puts("3 - - -");
		for(int i=0;i<4;i++){
			for(int j=0;j<4;j++){
				board[0][i][j]=0;
			}
		}
		cnt=1;
		return ;
	}
	else if(a=='N'||a=='n'){
		exit(0);
	}
	else cout << "잘못된 입력입니다. 다시 입력해주세요: ";
	}
}

void input(){
	if(ma==0) title();
  system("cls");
	int k=0,t=1,cnt1=0,x,y;
	puts("0 1 2 3 4 5 6 7 8 9 A B C D E F");
	puts("1 - - - - - - - - - - - - - - -");
	puts("2 - - - - - - - - - - - - - - -");
	puts("3 - - - - - - - - - - - - - - -");
	puts("4 - - - - - - - - - - - - - - -");
	puts("5 - - - - - - - - - - - - - - -");
	puts("6 - - - - - - - - - - - - - - -");
	puts("7 - - - - - - - - - - - - - - -");
	puts("8 - - - - - - - - - - - - - - -");
	puts("9 - - - - - - - - - - - - - - -");
	puts("A - - - - - - - - - - - - - - -");
	puts("B - - - - - - - - - - - - - - -");
	puts("C - - - - - - - - - - - - - - -");
	puts("D - - - - - - - - - - - - - - -");
	puts("E - - - - - - - - - - - - - - -");
	puts("F - - - - - - - - - - - - - - -");
	while(1){
		printf("cnt : %d \n", cnt);
		if(cnt==10){
			cout << "무승부 입니다. 다시하시겠습니까? Y/N: ";
      		return ;
		}
		if(cnt%2!=0) cout << "Player 1의 착수위치를 입력해주세요: ";
		else cout << "Player 2의 착수위치를 입력해주세요: ";
		while(1){
			cin >> x >> y;
			if(x<0||x>15||y<0||y>15||board[0][x][y]!=0) cout << "잘못된 입력입니다. 다시 입력해주세요: ";
			else break;
		}
		if(cnt%2!=0){
			board[0][x][y]=1; //player1 착수, board[0]은 루트노드
			score[0] = sc(0);
			for(int i = 1; i <= 24; i++){
				if(y+dy[i] > 15 || y+dy[i] < 0 || x+dx[i] > 15 || x+dx[i] < 0){
					score[i] = -100000000000;
					for(int j = 1; j <= 24; j++){
						score[i*24+j] = -100000000000;
						for(int k = 1; k <= 24; k++){
							score[(i*24+j)*24+k] = -100000000000;
						}
					}
				}
				else if(board[i][x+dx[i]][y+dy[i]] != 0){
					score[i] = -100000000000;
					for(int j = 1; j <= 24; j++){
						score[i*24+j] = -100000000000;
						for(int k = 1; k <= 24; k++){
							score[(i*24+j)*24+k] = -100000000000;
						}
					}
				}
				else{
					board[i][x+dx[i]][y+dy[i]] = 2;
					score[i] = sc(i);
					for(int j = 1; j <= 24; j++){
						if(y+dy[i]+dy[j] > 15 || y+dy[i]+dy[j] < 0 || x+dx[i]+dx[j] > 15 || x+dx[i]+dx[j] < 0){
							score[i*24+j] = -100000000000;
							for(int k = 1; k <= 24; k++){
								score[(i*24+j)*24+k] = -100000000000;
							}
						}
						else if(board[i*24+j][x+dx[j]+dx[i]][y+dy[j]+dy[i]] != 0){
							score[i*24+j] = -100000000000;
							for(int k = 1; k <= 24; k++){
								score[(i*24+j)*24+k] = -100000000000;
							}
						}
						else{
							board[i*24+j][x+dx[j]+dx[i]][y+dy[j]+dy[i]] = 1;
							score[i*24+j] = sc(i*24+j);
							for(int k = 1; k <= 24; k++){
								if(x+dx[j]+dx[i]+dx[k] < 0 || x+dx[j]+dx[i]+dx[k] > 15 || y+dy[j]+dy[i]+dy[k] < 0 || y+dy[j]+dy[i]+dy[k] > 15){
									score[(i*24+j)*24+k] = -100000000000;
								}
								if(board[(i*24+j)*24+k][x+dx[j]+dx[i]+dx[k]][y+dy[j]+dy[i]+dy[k]] != 0){	
									score[(i*24+j)*24+k] = -100000000000;
								}
								else{
									board[(i*24+j)*24+k][x+dx[j]+dx[i]+dx[k]][y+dy[j]+dy[i]+dy[k]] = 2;
									score[(i*24+j)*24+k] = sc((i*24+j)*24+k);
								}
							}
						}
					}
				}
			}
		}
		int temp = tree();
		printf("temp : %d\n", temp);
		board[0][x+dx[temp]][y+dy[temp]] = 2;
		score[0] = sc(0);
		cnt++;
		for(int i=0;i<15;i++){
			for(int j=0;j<15;j++){
				if(i==0){           //가로줄 번호 출력
					printf("%x ", k);
					k++;
					continue;
				}
				if(j==0){           //세로줄 번호 출력
					printf("%x ", t);
					t++;
					continue;
				}
				if(board[0][i][j]==0) cout << "- ";
				else if(board[0][i][j]==1) cout << "O ";
				else if(board[0][i][j]==2) cout << "X ";
			}
			puts("");
		}
		t=1,k=0;
		printf("score : %d \n", score[0]);
		if(score[0] > 50000000){
			cout << "AI의 승리! 다시하시겠습니까? Y/N : ";
			return ;
		}
	cnt ++;
	}
}
int main(){
  	input();
}

